openapi: '3.0.2'
info:
  title: Cheese Community API
  version: '1.0'
servers:
  - url: http://localhost:8080/api/{version}
    description: Local server
    variables:
      version:
        default: v1
components:
  securitySchemes:
    bearerAuth:
      description: The access token is used in this way.
      type: http
      scheme: bearer
      bearerFormat: JWT
    bearerAuth2:
      type: apiKey
      description: The refresh token is used in this way.
      name: REFRESH_TOKEN
      in: cookie

  schemas:
    CommonResponse:
      type: object
      properties:
        code:
          type: integer
          format: int32
          default: 0
          description: 错误码，0表示成功，其他表示失败
        message:
          type: string
          default: ''
          description: 错误信息，成功时为空字符串
      required:
        - code
        - message
    User:
      type: object
      properties:
        id:
          type: integer
          format: int64
        username:
          type: string
        nickname:
          type: string
        avatar:
          type: string
        intro:
          type: string
          default: ''
      required:
        - id
        - username
        - nickname
        - avatar
    Page:
      type: object
      description: 分页信息
      properties:
        page_start:
          type: integer
          format: int64
          description: 该页第一个 item 的 ID
        page_size:
          type: integer
          format: int64
          description: 每页 item 数量
        has_prev:
          type: boolean
          description: 是否有上一页
        prev_start:
          type: integer
          format: int64
          description: 上一页第一个 item 的 ID
        has_more:
          type: boolean
          description: 是否有下一页
        next_start:
          type: integer
          format: int64
          description: 下一页第一个 item 的 ID
    Topic:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
      required:
        - id
        - name
    Question:
      type: object
      description: 问题详情
      properties:
        id:
          type: integer
          format: int64
          description: 问题 ID
        title:
          type: string
          description: 问题标题
        content:
          type: string
          description: 问题详情
        author:
          $ref: '#/components/schemas/User'
        type:
          type: integer
          description: 问题类型
        topics:
          type: array
          items:
            $ref: '#/components/schemas/Topic'
        created_at:
          type: integer
          format: int64
          description: 创建时间（时间戳）
        updated_at:
          type: integer
          format: int64
          description: 最后修改时间（时间戳）
        is_follow:
          type: boolean
          description: 是否关注问题
        is_like:
          type: boolean
          description: 是否点赞问题
        answer_count:
          type: integer
          description: 回答数量
        comment_count:
          type: integer
          description: 评论数量
        follow_count:
          type: integer
          description: 关注数量
        like_count:
          type: integer
          description: 点赞数量
        view_count:
          type: integer
          description: 浏览数量
        is_group:
          type: boolean
          description: 是否为小组问题
        group:
          $ref: '#/components/schemas/Group'
    Answer:
      type: object
      description: 回答详情
      properties:
        id:
          type: integer
          format: int64
          description: 回答 ID
        question_id:
          type: integer
          format: int64
          description: 回答所属的问题 ID
        content:
          type: string
          description: 回答内容
        author:
          $ref: '#/components/schemas/User'
        created_at:
          type: integer
          format: int64
          description: 创建时间（时间戳）
        updated_at:
          type: integer
          format: int64
          description: 最后修改时间（时间戳）
        agree_type:
          type: integer
          description: 赞同类型，0表示未赞同，1表示赞同，2表示反对
          enum:
            - 0
            - 1
            - 2
        is_favorite:
          type: boolean
          description: 是否收藏回答
        agree_count:
          type: integer
          description: 赞同数量
        comment_count:
          type: integer
          description: 评论数量
        favorite_count:
          type: integer
          description: 收藏数量
        view_count:
          type: integer
          description: 浏览数量
        is_group:
          type: boolean
          description: 是否为小组回答
        group:
          $ref: '#/components/schemas/Group'
    Comment:
      type: object
      description: 评论详情
      properties:
        id:
          type: integer
          format: int64
          description: 评论 ID
        answer_id:
          type: integer
          format: int64
          description: 评论所属的回答 ID
        quote:
          type: object
          description: 回复的评论
          properties:
            id:
              type: integer
              format: int64
              description: 评论 ID
            user:
              $ref: '#/components/schemas/User'
        content:
          type: string
          description: 评论内容
        user:
          $ref: '#/components/schemas/User'
        created_at:
          type: integer
          format: int64
          description: 创建时间（时间戳）
        agree_type:
          type: integer
          description: 赞同类型，0表示未赞同，1表示赞同，2表示反对
          enum:
            - 0
            - 1
            - 2
        agree_count:
          type: integer
          description: 赞同数量
      required:
        - id
        - answer_id
        - content
        - user
        - created_at
        - agree_type
        - agree_count
    Group:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        intro:
          type: string
          default: ''
        owner:
          $ref: '#/components/schemas/User'
        created_at:
          type: integer
          format: int64
        updated_at:
          type: integer
          format: int64
        member_count:
          type: integer
          format: int64
        question_count:
          type: integer
          format: int64
        answer_count:
          type: integer
          format: int64
        is_member:
          type: boolean
        is_owner:
          type: boolean
        is_public:
          type: boolean
      required:
        - id
        - name
        - intro
    GroupTarget:
      type: object
      description: 小组目标
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        intro:
          type: string
          default: ''
        created_at:
          type: integer
          format: int64
        start_date:
          type: integer
          format: int64
        end_date:
          type: integer
          format: int64
        attendance:
          type: object
          description: 小组目标的打卡信息
          properties:
            frequency:
              type: string
              description: 打卡频率
              enum:
                - daily
                - weekly
                - monthly
      required:
        - id
        - name
        - intro
    Insight:
      type: object
      description: 灵感
      properties:
        id:
          type: integer
          description: ID
          format: int64
        content:
          type: string
          description: 内容
        author:
          $ref: '#/components/schemas/User'
        created_at:
          type: integer
          description: 创建时间
          format: int64
        updated_at:
          type: integer
          description: 最后更新时间
          format: int64
        is_like:
          type: boolean
          description: 当前用户是否点赞
        like_count:
          type: integer
          description: 点赞数量
        comment_count:
          type: integer
          description: 评论数量
        view_count:
          type: integer
          description: 浏览数量
        medias:
          type: array
          description: 媒体文件，如果没有则为空数组
          items:
            $ref: '#/components/schemas/Media'
        attachment:
          $ref: '#/components/schemas/Attachment'
      required:
        - id
        - content
        - author
        - created_at
        - updated_at
        - is_like
        - like_count
        - comment_count
        - view_count
        - medias
    Attachment:
      type: object
      description: 附件
      properties:
        type:
          type: string
          description: 类型
          enum:
            - file
            - link
        url:
          type: string
          description: URL
        title:
          type: string
          description: 标题
        description:
          type: string
          description: 描述
    Media:
      type: object
      properties:
        id:
          type: integer
          description: ID
          format: int64
        type:
          type: string
          description: 类型
          enum:
            - image
            - video
        url:
          type: string
          description: URL
        meta:
          oneOf:
            - $ref: '#/components/schemas/ImageMeta'
            - $ref: '#/components/schemas/VideoMeta'
    ImageMeta:
      type: object
      description: 图片元数据
      properties:
        width:
          type: integer
          description: 宽度
        height:
          type: integer
          description: 高度
        size:
          type: integer
          description: 大小
        thumbnail:
          type: string
          description: 缩略图 URL
    VideoMeta:
      type: object
      description: 视频元数据
      properties:
        width:
          type: integer
          description: 宽度
        height:
          type: integer
          description: 高度
        size:
          type: integer
          description: 大小
        duration:
          type: integer
          description: 时长
        thumbnail:
          type: string
          description: 缩略图 URL
    FileMeta:
      type: object
      description: 文件元数据
      properties:
        size:
          type: integer
          description: 大小
          format: int64
        name:
          type: string
          description: 文件名称
        type:
          type: string
          description: 文件类型
          enum:
            - image
            - video
            - audio
            - document
            - executable
            - other
        expires:
          type: integer
          description: 过期时间，如果为 0 表示永不过期
          format: int64
        user:
          $ref: '#/components/schemas/User'
    LinkMeta:
      type: object
      description: 链接元数据
      properties:
        title:
          type: string
          description: 页面标题
        abstract:
          type: string
          description: 页面摘要
        image:
          type: string
          description: 图片 URL
    LoginRequest:
      type: object
      properties:
        username:
          type: string
        password:
          type: string
      required:
        - username
        - password
    LoginResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                accessToken:
                  type: string
                user:
                  $ref: '#/components/schemas/User'
              required:
                - accessToken
                - user
          required:
            - data
    RegisterRequest:
      type: object
      properties:
        username:
          type: string
        nickname:
          type: string
        password:
          type: string
        email:
          type: string
        emailCode:
          type: string
      required:
        - username
        - nickname
        - password
        - email
        - emailCode
    RegisterResponse:
      allOf:
        - $ref: '#/components/schemas/CommonResponse'
        - type: object
          properties:
            data:
              type: object
              properties:
                accessToken:
                  type: string
                user:
                  $ref: '#/components/schemas/User'
              required:
                - accessToken
                - user
          required:
            - data

paths:
  /users:
    post:
      summary: 用户注册
      operationId: register
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
      responses:
        '201':
          description: User registered successfully
          headers:
            Set-Cookie:
              description: 'refresh token'
              schema:
                type: string
                example: 'RefreshToken=...; Secure; HttpOnly; SameSite=Strict; Path=/users/auth/; Expires=Sat, 01 Jan 2025 00:00:00 GMT'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegisterResponse'
  /users/auth/login:
    post:
      summary: 用户登录
      operationId: login
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: OK
          headers:
            Set-Cookie:
              description: 'refresh token'
              schema:
                type: string
                example: 'RefreshToken=...; Secure; HttpOnly; SameSite=Strict; Path=/users/auth; Expires=Sat, 01 Jan 2025 00:00:00 GMT'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
  /users/auth/refresh-token:
    post:
      summary: 用户刷新 token
      operationId: refresh-access-token
      security:
        - REFRESH_TOKEN: []
      responses:
        '200':
          description: OK
          headers:
            Set-Cookie:
              description: 'refresh token'
              schema:
                type: string
                example: 'RefreshToken=...; Secure; HttpOnly; SameSite=Strict; Path=/users/auth; Expires=Sat, 01 Jan 2025 00:00:00 GMT'
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          accessToken:
                            type: string
                        required:
                          - accessToken
                    required:
                      - data

  /users/auth/logout:
    post:
      summary: 用户退出登录
      operationId: logout
      security:
        - REFRESH_TOKEN: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'

  /users/verify/email:
    post:
      summary: 发送邮箱验证码
      operationId: verifyEmail
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
              required:
                - email
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
  /users/recover/password/request:
    post:
      summary: 重置密码请求
      operationId: recoverPasswordRequest
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
              required:
                - email
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
  /users/recover/password/verify:
    post:
      summary: 验证 Token 并重置密码
      operationId: recoverPasswordVerify
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
                new_password:
                  type: string
              required:
                - token
                - new_password
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
  /users/{id}:
    get:
      summary: 获取用户信息
      operationId: getUserInfo
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/User'
                    required:
                      - data
    put:
      summary: 更新用户信息
      operationId: updateUserInfo
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                nickname:
                  type: string
                avatar:
                  type: string
                intro:
                  type: string
              required:
                - nickname
                - avatar
                - intro
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
  /users/{id}/questions:
    get:
      summary: 获取用户提问列表
      operationId: getUserQuestions
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个问题的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页问题数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          questions:
                            type: array
                            items:
                              $ref: '#/components/schemas/Question'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
  /users/{id}/answers:
    get:
      summary: 获取用户回答列表
      operationId: getUserAnswers
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个回答的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页回答数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          answers:
                            type: array
                            items:
                              $ref: '#/components/schemas/Answer'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
  /users/{id}/followers:
    get:
      summary: 获取用户粉丝列表
      operationId: getUserFollowers
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个用户的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页用户数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          users:
                            type: array
                            items:
                              $ref: '#/components/schemas/User'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 关注用户
      operationId: followUser
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          follow_count:
                            type: integer
                            description: 新的关注者数量
                        required:
                          - follow_count
                    required:
                      - data
    delete:
      summary: 取消关注用户
      operationId: unfollowUser
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          follow_count:
                            type: integer
                            description: 新的关注者数量
                        required:
                          - follow_count
                    required:
                      - data
  /users/{id}/follow/questions:
    get:
      summary: 获取用户关注的问题列表
      operationId: getUserFollowQuestions
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个问题的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页问题数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          questions:
                            type: array
                            items:
                              $ref: '#/components/schemas/Question'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
  /users/{id}/follow/users:
    get:
      summary: 获取用户关注的用户列表
      operationId: getUserFollowUsers
      parameters:
        - name: id
          in: path
          description: 用户 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个用户的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页用户数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          users:
                            type: array
                            items:
                              $ref: '#/components/schemas/User'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
  /questions:
    get:
      summary: 获取问题列表
      operationId: getQuestions
      parameters:
        - name: q
          in: query
          description: 搜索关键词
          required: true
          schema:
            type: string
        - name: page_start
          in: query
          description: 该页第一个问题的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页问题数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          questions:
                            type: array
                            items:
                              $ref: '#/components/schemas/Question'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 提问
      operationId: askQuestion
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                content:
                  type: string
                type:
                  type: integer
                  description: 问题类型
                topics:
                  type: array
                  items:
                    type: integer
                    format: int64
                group_id:
                  type: integer
                  format: int64
                  description: 所属小组 ID，留空表示不属于任何小组
              required:
                - title
                - content
                - type
                - topics
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                    required:
                      - data
  /questions/{id}:
    get:
      summary: 获取问题详情
      operationId: getQuestionDetail
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          question:
                            $ref: '#/components/schemas/Question'
                    required:
                      - data
    put:
      summary: 更新问题
      operationId: updateQuestion
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                content:
                  type: string
                type:
                  type: integer
                  description: 问题类型
                topics:
                  type: array
                  items:
                    type: integer
                    format: int64
              required:
                - title
                - content
                - type
                - topics
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
    delete:
      summary: 删除问题
      operationId: deleteQuestion
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
  /questions/{id}/followers:
    get:
      summary: 获取问题关注者列表
      operationId: getQuestionFollowers
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个用户的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页用户数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          users:
                            type: array
                            items:
                              $ref: '#/components/schemas/User'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    put:
      summary: 关注问题
      operationId: followQuestion
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          follow_count:
                            type: integer
                            description: 新的关注者数量
                        required:
                          - follow_count
                    required:
                      - data
    delete:
      summary: 取消关注问题
      operationId: unfollowQuestion
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          follow_count:
                            type: integer
                            description: 新的关注者数量
                        required:
                          - follow_count
                    required:
                      - data
  /questions/{id}/answers:
    get:
      summary: 获取问题回答列表
      operationId: getQuestionAnswers
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个回答的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页回答数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          answers:
                            type: array
                            items:
                              $ref: '#/components/schemas/Answer'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 回答问题
      operationId: answerQuestion
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
              required:
                - content
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                        required:
                          - id
                    required:
                      - data
  /questions/{id}/answers/{answer_id}:
    get:
      summary: 获取回答详情
      operationId: getAnswerDetail
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          question:
                            $ref: '#/components/schemas/Question'
                          answer:
                            $ref: '#/components/schemas/Answer'
                    required:
                      - data
    put:
      summary: 更新回答
      operationId: updateAnswer
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
              required:
                - content
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
    delete:
      summary: 删除回答
      operationId: deleteAnswer
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
  /questions/{id}/answers/{answer_id}/agree:
    put:
      summary: 赞同回答
      operationId: agreeAnswer
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                agree_type:
                  type: integer
                  description: 赞同类型，0表示未赞同，1表示赞同，2表示反对
                  enum:
                    - 0
                    - 1
                    - 2
              required:
                - agree_type
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          agree_count:
                            type: integer
                            description: 新的赞同数量
                        required:
                          - agree_count
                    required:
                      - data
  /questions/{id}/answers/{answer_id}/favorite:
    put:
      summary: 收藏回答
      operationId: favoriteAnswer
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
    delete:
      summary: 取消收藏回答
      operationId: unfavoriteAnswer
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
  /questions/{id}/answers/{answer_id}/comments:
    get:
      summary: 获取回答评论列表
      operationId: getAnswerComments
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个评论的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页评论数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comments:
                            type: array
                            items:
                              type: object
                              allOf:
                                - $ref: '#/components/schemas/Comment'
                                - type: object
                                  properties:
                                    sub_comment_count:
                                      type: integer
                                      description: 子评论数量
                                    sub_comments:
                                      type: array
                                      items:
                                        $ref: '#/components/schemas/Comment'
                          page:
                            $ref: '#/components/schemas/Page'
    post:
      summary: 评论回答
      operationId: commentAnswer
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
                reply_id:
                  type: integer
                  format: int64
              required:
                - content
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                        required:
                          - id
                    required:
                      - data
  /questions/{id}/answers/{answer_id}/comments/{comment_id}:
    get:
      summary: 获取评论详情
      operationId: getCommentDetail
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: comment_id
          in: path
          description: 评论 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个子评论的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页子评论数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comment:
                            $ref: '#/components/schemas/Comment'
                          sub_comments:
                            type: array
                            items:
                              $ref: '#/components/schemas/Comment'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    delete:
      summary: 删除评论
      operationId: deleteComment
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: comment_id
          in: path
          description: 评论 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
  /questions/{id}/answers/{answer_id}/comments/{comment_id}/agree:
    put:
      summary: 赞同评论
      operationId: agreeComment
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: answer_id
          in: path
          description: 回答 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: comment_id
          in: path
          description: 评论 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                agree_type:
                  type: integer
                  description: 赞同类型，0表示未赞同，1表示赞同，2表示反对
                  enum:
                    - 0
                    - 1
                    - 2
              required:
                - agree_type
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
  /topics:
    get:
      summary: 获取话题列表
      operationId: getTopics
      parameters:
        - name: q
          in: query
          description: 搜索关键词
          required: true
          schema:
            type: string
        - name: page_start
          in: query
          description: 该页第一个话题的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页话题数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          topics:
                            type: array
                            items:
                              $ref: '#/components/schemas/Topic'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 创建话题
      operationId: createTopic
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
              required:
                - name
      responses:
        '201':
          description: Topic created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                    required:
                      - data
  /topics/{id}:
    get:
      summary: 获取话题详情
      operationId: getTopicDetail
      parameters:
        - name: id
          in: path
          description: 问题 ID
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          topic:
                            $ref: '#/components/schemas/Topic'
                    required:
                      - data
  /groups:
    get:
      summary: 获取圈子列表
      operationId: getGroups
      parameters:
        - name: q
          in: query
          description: 搜索关键词，留空即为获取全部圈子
          schema:
            type: string
        - name: page_start
          in: query
          description: 该页第一个圈子的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页圈子数量
          schema:
            type: integer
            format: int64
            default: 20
        - name: sort
          in: query
          description: 排序方式
          schema:
            type: string
            enum:
              - recommend
              - hot
              - new
            default: recommend
        - name: joined
          in: query
          description: 是否为我参与的小组
          schema:
            type: boolean
        - name: managed
          in: query
          description: 是否为我管理的小组
          schema:
            type: boolean
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          groups:
                            type: array
                            items:
                              $ref: '#/components/schemas/Group'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 创建圈子
      operationId: createGroup
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                intro:
                  type: string
                avatar:
                  type: string
                public:
                  type: boolean
              required:
                - name
                - intro
                - avatar
                - public
      responses:
        '201':
          description: Group created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                    required:
                      - data
  /groups/{id}:
    get:
      summary: 获取圈子详情
      operationId: getGroupDetail
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          group:
                            $ref: '#/components/schemas/Group'
                    required:
                      - data
    put:
      summary: 更新圈子
      operationId: updateGroup
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                intro:
                  type: string
                avatar:
                  type: string
                cover:
                  type: string
              required:
                - name
                - intro
                - avatar
                - cover
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
    delete:
      summary: 删除圈子
      operationId: deleteGroup
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
  /groups/{id}/members:
    get:
      summary: 获取圈子成员列表
      operationId: getGroupMembers
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个用户的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页用户数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          members:
                            type: array
                            items:
                              $ref: '#/components/schemas/User'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 加入圈子
      operationId: joinGroup
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                intro:
                  type: string
              required:
                - intro
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          member_count:
                            type: integer
                            description: 新的成员数量
                          is_member:
                            type: boolean
                            description: 是否已加入圈子
                          is_waiting:
                            type: boolean
                            description: 是否正在等待审核
                    required:
                      - data
    delete:
      summary: 退出圈子
      operationId: quitGroup
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          member_count:
                            type: integer
                            description: 新的成员数量
                    required:
                      - data
  /groups/{id}/questions:
    get:
      summary: 获取圈子问题列表
      operationId: getGroupQuestions
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个问题的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页问题数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          questions:
                            type: array
                            items:
                              $ref: '#/components/schemas/Question'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
  /groups/{id}/targets:
    get:
      summary: 获取圈子目标列表
      operationId: getGroupTargets
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个目标的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页目标数量
          schema:
            type: integer
            format: int64
            default: 20
        - name: type
          in: query
          description: 目标类型
          schema:
            type: string
            enum:
              - recommend
              - hot
              - new
            default: recommend
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          targets:
                            type: array
                            items:
                              $ref: '#/components/schemas/GroupTarget'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 创建圈子目标
      operationId: createGroupTarget
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                intro:
                  type: string
                start_time:
                  type: integer
                  format: int64
                end_time:
                  type: integer
                  format: int64
                attendance:
                  type: object
                  description: 目标打卡设置
                  properties:
                    type:
                      type: string
                      enum:
                        - daily
                        - weekly
                        - monthly
              required:
                - name
                - intro
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                    required:
                      - data
  /groups/{id}/targets/{target_id}:
    get:
      summary: 获取圈子目标详情
      operationId: getGroupTargetDetail
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: target_id
          in: path
          description: 目标 ID
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
    put:
      summary: 更新圈子目标
      operationId: updateGroupTarget
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: target_id
          in: path
          description: 目标 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                intro:
                  type: string
                start_time:
                  type: integer
                  format: int64
                end_time:
                  type: integer
                  format: int64
                attendance:
                  type: object
                  description: 目标打卡设置
                  properties:
                    type:
                      type: string
                      enum:
                        - daily
                        - weekly
                        - monthly
              required:
                - name
                - intro
                - start_time
                - end_time
                - attendance
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
    delete:
      summary: 删除圈子目标
      operationId: deleteGroupTarget
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: target_id
          in: path
          description: 目标 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
  /groups/{id}/targets/{target_id}/attend:
    post:
      summary: 打卡
      operationId: attendGroupTarget
      parameters:
        - name: id
          in: path
          description: 圈子 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: target_id
          in: path
          description: 目标 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
  /feeds:
    get:
      summary: 获取动态列表
      operationId: getFeedList
      parameters:
        - name: page_start
          in: query
          description: 该页第一个动态的 ID，留空即为加载最新动态
          schema:
            type: string
        - name: page_size
          in: query
          description: 每页动态数量
          schema:
            type: integer
            format: int64
            default: 20
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          feeds:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                  description: 动态 ID
                                from:
                                  type: string
                                  description: 动态来源
                                  enum:
                                    - follow_question
                                    - follow_user
                                    - follow_topic
                                    - hot
                                    - personalized
                                type:
                                  type: string
                                  description: 动态类型
                                  enum:
                                    - question
                                    - answer
                                data:
                                  type: object
                                  description: 动态数据
                                  oneOf:
                                    - $ref: '#/components/schemas/Question'
                                    - $ref: '#/components/schemas/Answer'
                              required:
                                - from
                                - type
                                - data
                          page:
                            type: object
                            properties:
                              page_size:
                                type: integer
                                format: int64
                                description: 每页动态数量
                              next_start:
                                type: string
                                description: 下一页第一条动态的 ID
                              has_more:
                                type: boolean
                                description: 是否还有更多动态
                    required:
                      - data
  /hot:
    get:
      summary: 获取热门问题列表
      operationId: getHotQuestionList
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          questions:
                            type: array
                            items:
                              $ref: '#/components/schemas/Question'
                    required:
                      - data
  /search:
    get:
      summary: 搜索
      operationId: search
      parameters:
        - name: q
          in: query
          description: 搜索关键词
          required: true
          schema:
            type: string
        - name: type
          in: query
          description: 搜索类型
          schema:
            type: string
            enum:
              - question
              - answer
              - user
              - topic
            default: question
        - name: page_start
          in: query
          description: 该页第一个搜索结果的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页搜索结果数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          results:
                            type: array
                            items:
                              oneOf:
                                - $ref: '#/components/schemas/Question'
                                - $ref: '#/components/schemas/Answer'
                                - $ref: '#/components/schemas/User'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
  /images:
    post:
      summary: 上传图片
      operationId: uploadImage
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: 图片 ID
  /insights:
    post:
      summary: 创建灵感
      operationId: createInsight
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
                  description: 纯文本内容
                medias:
                  type: array
                  description: 媒体文件（图片或视频）列表
                  items:
                    type: object
                    properties:
                      type:
                        type: string
                        enum:
                          - image
                          - video
                      id:
                        type: number
                        format: int64
                attachment:
                  oneOf:
                    - type: object
                      description: 附件文件
                      properties:
                        type:
                          type: string
                          enum:
                            - file
                        id:
                          type: number
                          format: int64
                    - type: object
                      description: 附件链接
                      properties:
                        type:
                          type: string
                          enum:
                            - link
                        url:
                          type: string
                          example: https://example.com
              required:
                - content
      responses:
        '201':
          description: Insight created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                        required:
                          - id
                    required:
                      - data
  /insights/{id}:
    get:
      summary: 获取灵感详情
      operationId: getInsightDetail
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          insight:
                            $ref: '#/components/schemas/Insight'
                    required:
                      - data
    put:
      summary: 更新灵感
      operationId: updateInsight
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
              required:
                - content
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
    delete:
      summary: 删除灵感
      operationId: deleteInsight
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
  /insights/{id}/likes:
    get:
      summary: 获取点赞用户列表
      operationId: getInsightLikes
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个点赞用户的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页点赞用户数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          likes:
                            type: array
                            items:
                              $ref: '#/components/schemas/User'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    put:
      summary: 点赞灵感
      operationId: likeInsight
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
    delete:
      summary: 取消点赞灵感
      operationId: unlikeInsight
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
  /insights/{id}/comments:
    get:
      summary: 获取灵感评论列表
      operationId: getInsightComments
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个评论的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页评论数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comments:
                            type: array
                            items:
                              type: object
                              allOf:
                                - $ref: '#/components/schemas/Comment'
                                - type: object
                                  properties:
                                    sub_comment_count:
                                      type: integer
                                      description: 子评论数量
                                    sub_comments:
                                      type: array
                                      items:
                                        $ref: '#/components/schemas/Comment'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 评论灵感
      operationId: commentInsight
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
                reply_id:
                  type: integer
                  format: int64
              required:
                - content
      responses:
        '201':
          description: Comment for insight created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                        required:
                          - id
                    required:
                      - data
  /insights/{id}/comments/{comment_id}:
    get:
      summary: 获取评论详情
      operationId: getInsightCommentDetail
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: comment_id
          in: path
          description: 评论 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个子评论的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页子评论数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          comment:
                            $ref: '#/components/schemas/Comment'
                          sub_comments:
                            type: array
                            items:
                              $ref: '#/components/schemas/Comment'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    post:
      summary: 回复评论
      operationId: replyInsightComment
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: comment_id
          in: path
          description: 评论 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                content:
                  type: string
              required:
                - content
      responses:
        '201':
          description: Reply for insight comment created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: integer
                            format: int64
                        required:
                          - id
                    required:
                      - data
    delete:
      summary: 删除评论
      operationId: deleteInsightComment
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: comment_id
          in: path
          description: 评论 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      responses:
        '204':
          description: No Content
  /insights/{id}/comments/{comment_id}/agrees:
    get:
      summary: 获取赞同用户列表
      operationId: getInsightCommentAgrees
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: comment_id
          in: path
          description: 评论 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: page_start
          in: query
          description: 该页第一个赞同用户的 ID，留空即为从头开始
          schema:
            type: integer
            format: int64
        - name: page_size
          in: query
          description: 每页赞同用户数量
          schema:
            type: integer
            format: int64
            default: 20
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/CommonResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          agrees:
                            type: array
                            items:
                              $ref: '#/components/schemas/User'
                          page:
                            $ref: '#/components/schemas/Page'
                    required:
                      - data
    put:
      summary: 赞同评论
      operationId: agreeInsightComment
      parameters:
        - name: id
          in: path
          description: 灵感 ID
          required: true
          schema:
            type: integer
            format: int64
        - name: comment_id
          in: path
          description: 评论 ID
          required: true
          schema:
            type: integer
            format: int64
      security:
        - bearerAuth: []
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                agree_type:
                  type: integer
                  description: 赞同类型，0表示未赞同，1表示赞同，2表示反对
                  enum:
                    - 0
                    - 1
                    - 2
              required:
                - agree_type
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CommonResponse'
